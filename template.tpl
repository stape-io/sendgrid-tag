___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "SendGrid",
  "brand": {
    "id": "brand_dummy",
    "displayName": "Stape",
    "thumbnail": "data:image/png;base64,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RZwJECBAgACBFQEjY4XRJQQIECBAgMAUMDKmiDMBAgQIECCwImBkrDC6hAABAgQIEJgCRsYUcSZAgAABAgRWBIyMFUaXECBAgAABAlPAyJgizgQIECBAgMCKgJGxwugSAgQIECBAYAoYGVPEmQABAgQIEFgRMDJWGF1CgAABAgQITAEjY4o4EyBAgAABAisCRsYKo0sIECBAgACBKWBkTBFnAgQIECBAYEXAyFhhdAkBAgQIECAwBYyMKeJMgAABAgQIrAg8fn7Lr3770fOvPglUCrz7o6cPvvH2k8rsQhP4UuAfjx+9R4JAq8CTRw8/+OMI/2JkjJ87EqgT+NbT1x9852tGRl1xAr8Q+OW33/jNi4MvBA4I+HPJgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCRkZiKzIRIECAAIEDAkbGgRI9gQABAgQIJAoYGYmtyESAAAECBA4IGBkHSvQEAgQIECCQKGBkJLYiEwECBAgQOCBgZBwo0RMIECBAgECigJGR2IpMBAgQIEDggICRcaBETyBAgAABAokCj5+H+vkP33zv+XefBBoFvvnmk4/efvLok8bsMhMgQIAAAQIECBAgQIAAAQIECBAgQIDA/1Pg3xpHMT6fR1+LAAAAAElFTkSuQmCC"
  },
  "description": "Allow sending an email and create/update contacts.",
  "containerContexts": [
    "SERVER"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "apiKey",
    "displayName": "API Key",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "help": "You can find info on \u003ca href\u003d\"https://docs.sendgrid.com/api-reference/how-to-use-the-sendgrid-v3-api/authentication#api-keys\" target\u003d\"_blank\"\u003ehow to get API key by this link\u003c/a\u003e."
  },
  {
    "type": "RADIO",
    "name": "action",
    "displayName": "Action",
    "radioItems": [
      {
        "value": "email",
        "displayValue": "Send email"
      },
      {
        "value": "contact",
        "displayValue": "Add or Update a Contact"
      }
    ],
    "simpleValueType": true,
    "defaultValue": "email"
  },
  {
    "type": "GROUP",
    "name": "emailGroup",
    "groupStyle": "NO_ZIPPY",
    "subParams": [
      {
        "type": "TEXT",
        "name": "emailFrom",
        "displayName": "From",
        "simpleValueType": true,
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "emailTo",
        "displayName": "To",
        "simpleValueType": true,
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "emailSubject",
        "displayName": "Subject",
        "simpleValueType": true,
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "emailText",
        "displayName": "Content",
        "simpleValueType": true,
        "help": "You can use your \u003cb\u003eVariables\u003c/b\u003e in this field. \nExample of the text:  Your {{Event Name}} triggered.",
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      }
    ],
    "enablingConditions": [
      {
        "paramName": "action",
        "paramValue": "email",
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "contactGroup",
    "groupStyle": "NO_ZIPPY",
    "subParams": [
      {
        "type": "TEXT",
        "name": "contactLists",
        "displayName": "List IDs",
        "simpleValueType": true,
        "help": "List ID strings that this contact will be added to. Separate multiple IDs with commas."
      },
      {
        "type": "TEXT",
        "name": "contactEmail",
        "displayName": "Email",
        "simpleValueType": true,
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      },
      {
        "type": "LABEL",
        "name": "contactDefaultLabel",
        "displayName": "Actual list of standard contact fields can be found \u003ca target\u003d\"_blank\" href\u003d\"https://docs.sendgrid.com/api-reference/contacts/add-or-update-a-contact#body\"\u003ehere.\u003c/a\u003e"
      },
      {
        "type": "GROUP",
        "name": "contactDefaultGroup",
        "displayName": "Contact Default Fields",
        "groupStyle": "ZIPPY_CLOSED",
        "subParams": [
          {
            "type": "SIMPLE_TABLE",
            "name": "contactDefault",
            "simpleTableColumns": [
              {
                "defaultValue": "",
                "displayName": "Name",
                "name": "name",
                "type": "TEXT"
              },
              {
                "defaultValue": "",
                "displayName": "Value",
                "name": "value",
                "type": "TEXT"
              }
            ]
          }
        ]
      },
      {
        "type": "GROUP",
        "name": "contactCustomGroup",
        "displayName": "Contact Custom Fields",
        "groupStyle": "ZIPPY_CLOSED",
        "subParams": [
          {
            "type": "SIMPLE_TABLE",
            "name": "contactCustom",
            "simpleTableColumns": [
              {
                "defaultValue": "",
                "displayName": "Name",
                "name": "name",
                "type": "TEXT"
              },
              {
                "defaultValue": "",
                "displayName": "Value",
                "name": "value",
                "type": "TEXT"
              }
            ]
          }
        ]
      }
    ],
    "enablingConditions": [
      {
        "paramName": "action",
        "paramValue": "contact",
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "logsGroup",
    "displayName": "Logs Settings",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "RADIO",
        "name": "logType",
        "radioItems": [
          {
            "value": "no",
            "displayValue": "Do not log"
          },
          {
            "value": "debug",
            "displayValue": "Log to console during debug and preview"
          },
          {
            "value": "always",
            "displayValue": "Always log to console"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "debug"
      }
    ]
  }
]


___SANDBOXED_JS_FOR_SERVER___

const sendHttpRequest = require('sendHttpRequest');
const JSON = require('JSON');
const makeTableMap = require('makeTableMap');
const getRequestHeader = require('getRequestHeader');
const logToConsole = require('logToConsole');
const getContainerVersion = require('getContainerVersion');
const containerVersion = getContainerVersion();
const isDebug = containerVersion.debugMode;
const isLoggingEnabled = determinateIsLoggingEnabled();
const traceId = getRequestHeader('trace-id');

let apiUrl, method, eventName, requestBody;

if (data.action === 'email') {
    apiUrl = '/mail/send';
    eventName = 'Email';
    method = 'POST';

    requestBody = {
        'personalizations': [
            {
                'to': [{'email': data.emailTo}]
            }
        ],
        'from': {'email': data.emailFrom},
        'subject': data.emailSubject,
        'content': [{'type': 'text/html', 'value': data.emailText}]
    };
} else {
    apiUrl = '/marketing/contacts';
    eventName = 'Contact';
    method = 'PUT';

    requestBody = {
        'contacts': [data.contactDefault && data.contactDefault.length ? makeTableMap(data.contactDefault, 'name', 'value') : {}]
    };

    requestBody.contacts[0].email = data.contactEmail;

    if (data.contactLists) {
        requestBody.list_ids = data.contactLists.split(',');
    }

    if (data.contactCustom && data.contactCustom.length) {
        requestBody.contacts[0].custom_fields = makeTableMap(data.contactCustom, 'name', 'value');
    }
}


const requestUrl = 'https://api.sendgrid.com/v3' + apiUrl;

if (isLoggingEnabled) {
    logToConsole(JSON.stringify({
        'Name': 'SendGrid',
        'Type': 'Request',
        'TraceId': traceId,
        'EventName': eventName,
        'RequestMethod': method,
        'RequestUrl': requestUrl,
        'RequestBody': requestBody,
    }));
}

sendHttpRequest(requestUrl, (statusCode, headers, body) => {
    if (isLoggingEnabled) {
        logToConsole(JSON.stringify({
            'Name': 'SendGrid',
            'Type': 'Response',
            'TraceId': traceId,
            'EventName': eventName,
            'ResponseStatusCode': statusCode,
            'ResponseHeaders': headers,
            'ResponseBody': body,
        }));
    }

    if (statusCode >= 200 && statusCode < 300) {
        data.gtmOnSuccess();
    } else {
        data.gtmOnFailure();
    }
}, {
    method: method,
    headers: {'Content-Type': 'application/json', 'Authorization': 'Bearer ' + data.apiKey}
}, JSON.stringify(requestBody));

function determinateIsLoggingEnabled() {
    if (!data.logType) {
        return isDebug;
    }

    if (data.logType === 'no') {
        return false;
    }

    if (data.logType === 'debug') {
        return isDebug;
    }

    return data.logType === 'always';
}


___SERVER_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "send_http",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://api.sendgrid.com/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_request",
        "versionId": "1"
      },
      "param": [
        {
          "key": "headerWhitelist",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "trace-id"
                  }
                ]
              }
            ]
          }
        },
        {
          "key": "headersAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "requestAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "headerAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "queryParameterAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_container_data",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 18/03/2022, 12:12:22


